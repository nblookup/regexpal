<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<!--
	RegexPal 0.1.4c
	(c) 2007-2008 Steven Levithan <stevenlevithan.com>
	GNU LGPL 3.0 license
-->

<!-- This is the HTML content from index.cfm. This copy does not support permalinks. -->

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>Regex Tester &ndash; RegexPal</title>
	<link href="./assets/regexpal.css" rel="stylesheet" type="text/css"/>
</head>
<script>
	function dropdownChange() {
	// Dropdown to show tests
	const dd = document.getElementById('solution-dropdown');

	dd.addEventListener('change', function handleChange(event) {
		const solns = document.querySelectorAll(".solution");

		solns.forEach((soln) => {
			soln.style.display = 'none';
		});

		const selected = document.getElementById(event.target.value);
		selected.style.display = 'block';
	});
}
</script>
<body>
	<div id="header">
		<img src="./assets/patternpal.png" alt=PatternPal"/ class="logo">
	</div>

	<div id="quickReference" class="hidden">
		<h2>JavaScript Regex Quick Reference</h2>
		<img src="./assets/pin.gif" class="pin" alt="pin" title="pin"/>
		<img src="./assets/close.gif" class="close" alt="close" title="close"/>
		<table cellspacing="0" summary="Regular expressions reference">
			<tbody>
				<tr>
					<td><code>.</code></td>
					<td>Any character except newline.</td>
				</tr>
				<tr class="altBg">
					<td><code>\.</code></td>
					<td>A period (and so on for <code>\*</code>, <code>\(</code>, <code>\\</code>, etc.)</td>
				</tr>
				<tr>
					<td><code>^</code></td>
					<td>The start of the string.</td>
				</tr>
				<tr class="altBg">
					<td><code>$</code></td>
					<td>The end of the string.</td>
				</tr>
				<tr>
					<td><code>\d</code>,<code>\w</code>,<code>\s</code></td>
					<td>A digit, word character <code>[A-Za-z0-9_]</code>, or whitespace.</td>
				</tr>
				<tr class="altBg">
					<td><code>\D</code>,<code>\W</code>,<code>\S</code></td>
					<td>Anything except a digit, word character, or whitespace.</td>
				</tr>
				<tr>
					<td><code>[abc]</code></td>
					<td>Character a, b, or c.</td>
				</tr>
				<tr class="altBg">
					<td><code>[a-z]</code></td>
					<td>a through z.</td>
				</tr>
				<tr>
					<td><code>[^abc]</code></td>
					<td>Any character except a, b, or c.</td>
				</tr>
				<tr class="altBg">
					<td><code>aa|bb</code></td>
					<td>Either aa or bb.</td>
				</tr>
				<tr>
					<td><code>?</code></td>
					<td>Zero or one of the preceding element.</td>
				</tr>
				<tr class="altBg">
					<td><code>*</code></td>
					<td>Zero or more of the preceding element.</td>
				</tr>
				<tr>
					<td><code>+</code></td>
					<td>One or more of the preceding element.</td>
				</tr>
				<tr class="altBg">
					<td><code>{<em>n</em>}</code></td>
					<td>Exactly <em>n</em> of the preceding element.</td>
				</tr>
				<tr>
					<td><code>{<em>n</em>,}</code></td>
					<td><em>n</em> or more of the preceding element.</td>
				</tr>
				<tr class="altBg">
					<td><code>{<em>m</em>,<em>n</em>}</code></td>
					<td>Between <em>m</em> and <em>n</em> of the preceding element.</td>
				</tr>
				<tr>
					<td><code>??</code>,<code>*?</code>,<code>+?</code>,<br/><code>{<em>n</em>}?</code>, etc.</td>
					<td>Same as above, but as few times as possible.</td>
				</tr>
				<tr class="altBg">
					<td><code>(</code><em>expr</em><code>)</code></td>
					<td>Capture <em>expr</em> for use with <code>\1</code>, etc.</td>
				</tr>
				<tr>
					<td><code>(?:</code><em>expr</em><code>)</code></td>
					<td>Non-capturing group.</td>
				</tr>
				<tr class="altBg">
					<td><code>(?=</code><em>expr</em><code>)</code></td>
					<td>Followed by <em>expr</em>.</td>
				</tr>
				<tr>
					<td><code>(?!</code><em>expr</em><code>)</code></td>
					<td>Not followed by <em>expr</em>.</td>
				</tr>
			</tbody>
		</table>
		<p><a href="http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:RegExp#Special_characters_in_regular_expressions">Near-complete reference</a></p>
	</div>

	<div id="body">
		<div id="container">
			<div id="left" class="box">
				<div id="key" class="smartField">
					<textarea cols="100" rows="3" tabindex="1" placeholder="Enter API key here."></textarea>
				</div>
				<div id="query" class="smartField">
					<textarea class=""cols="100" rows="3" tabindex="1" placeholder="Enter query here."></textarea>
				</div>
				<button type="button" id="query-butt" onclick="onQuery()">Submit</button>
				<div id="search" class="smartField">
					<textarea cols="100" rows="3" tabindex="1" placeholder="Enter regex here."></textarea>
				</div>
				<div id="solution-container">
					<div id="error-container"></div>
					<label for="solution-names" id="solution-label">Select a solution:</label> 
					<select name="solution-names" id="solution-dropdown" onchange="dropdownChange()"> 
						<option value="solution-1">Solution 1</option> 
						<option value="solution-2">Solution 2</option> 
						<option value="solution-3">Solution 3</option> 
						<option value="solution-4">Solution 4</option> 
					</select>
					<p id="solution-1" class="default solution">Solution 1</p>
					<p id="solution-2" class="solution">Solution 2</p>
					<p id="solution-3" class="solution">Solution 3</p>
					<p id="solution-4" class="solution">Solution 4</p>
				</div>
			</div>
			<div id="right" class="box">
				<div id="tests-container">
					<div id="best"></div>
					<div id="passed"></div>
					<div id="failed"></div>
				</div>
			</div>
		</div>
	</div>

	<div id="footer" class="small">
		<p>Designed by Sean Yang and Binita Gupta, built on RegexPal</p>
		<p id="copyright">&copy; 2023 <a href="https://github.com/binita-g/pattern-pal-4">Github</a>
	</div>

	<script src="./assets/xregexp.js"></script>
	<script src="./assets/helpers.js"></script>
	<script src="./assets/regexpal.js"></script>
  <script src="./assets/patternpal.js"></script>
  <script>
    const patternpal = new PatternPal();

	// Listen for API key changes and update patternpal
	const api_key = document.getElementById('key').getElementsByTagName('textarea')[0];

	api_key.addEventListener('input', function handleChange(event) {
        patternpal.setApiKey(api_key.value);
    });

    // TODO: testing only REMOVE BEFORE PUBLISHING
    // mock the solutions
    patternpal.solutions = [
      `^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$`,
      `^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$`,
      `^(?:[a-zA-Z0-9]+(?:\.[a-zA-Z0-9]+)*)@[a-zA-Z0-9]+(?:\.[a-zA-Z0-9]+)+$`,
      `^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]{2,}$`,
      `^[\w\d._%+-]+@(?:[\w\d-]+\.)+\w{2,}$`,
    ].map(regString => new RegExp(regString));

    // mock the tests
    patternpal.tests = [
      (regex) => {
      // Explanation: A valid email address must have a "@" symbol
      return regex.test("test@example.com");
      },
      (regex) => {
      // Explanation: A valid email address must have a "." symbol
      return regex.test("john.doe123@gmail.com");
      },
      (regex) => {
      // Explanation: A valid email address must end with a valid domain name
      return regex.test("jane@company.co.uk");
      },
      (regex) => {
      // Explanation: A valid email address must not have spaces
      return regex.test("user123@example-domain.net");
      },
      (regex) => {
      // Explanation: A valid email address must not have spaces
      return !regex.test("first. last@subdomain. example.com");
      },
      (regex) => {
      // Explanation: An empty string is not a valid email address
      return !regex.test("");
      },
      (regex) => {
      // Explanation: An email address must contain the "a" symbol
      return !regex.test("test.example.com");
      },
      (regex) => {
      // Explanation: The domain part of an email address must be a valid domain name
      return !regex.test("test@example.123");
      },
      (regex) => {
      // Explanation: An email address should have exactly one "@" symbol
      return !regex.test ("test@example@example.com");
      },
      (regex) => {
      // Explanation: The local part of an email address should not contain special characters like "$"
      return !regex.test ("te$st@example.com");
      },
    ];

    patternpal.getTestsPassedByBestSolution = () => {
      return [
        patternpal.tests[3].toString(),
        patternpal.tests[4].toString(),
        patternpal.tests[5].toString(),
        patternpal.tests[6].toString(),
        patternpal.tests[7].toString(),
        patternpal.tests[8].toString(),
        patternpal.tests[9].toString(),
      ]
    };

    patternpal.getTestsFailedByBestSolution = () => {
      return [
        patternpal.tests[0].toString(),
        patternpal.tests[1].toString(),
        patternpal.tests[2].toString(),
      ]
    };

    patternpal.best_solution = 0;

    patternpal.best_tests = [0, 2];

    patternpal.query =
      async () => {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            resolve();
          }, 1000);
        });
      };

    // TODO: ^^^^

    function showError(err) {
      document.getElementById('error-container').innerText = err;
    }

    function removeError() {
      document.getElementById('error-container').innerText = '';
    }
	
    const query = document.getElementById('query').getElementsByTagName('textarea')[0];

    // Watch for changes in the input field and update the prompt
    function watchInput() {
      query.addEventListener('input', function handleChange(event) {
        patternpal.setPrompt(query.value);
      });
    }
    watchInput();

	function populateSolutions() {
      const solutions = patternpal.getAllSolutions();
      console.log(solutions);
      const best_solution = patternpal.getBestSolution();

      console.log("solutions", solutions);

	  document.getElementById('solution-container').innerText = solutions
	
    // Set the value of search to the best solution
    document.getElementById('search').getElementsByTagName('textarea')[0].value = best_solution;
    }

    function populateTests() {
      const best = patternpal.getBestTests();
      console.log("best", best);
      const passed = patternpal.getTestsPassedByBestSolution();
      console.log("passed", passed);
      const failed = patternpal.getTestsFailedByBestSolution();
	  console.log("failed", failed);

      // TODO: populate
	  document.getElementById('best').textContent = best
	  document.getElementById('passed').textContent = passed
	  document.getElementById('failed').textContent = failed

    }
	
    // On query, use PatternPal to query for solutions and tests
    function onQuery() {
      // TODO: set the button to loading
      // make sure that the query is not empty
      if (!query.value) {
        // TODO: Show error
        console.log('query is empty');
        return;
      }
      patternpal.query()
        .then(() => {
          // Remove existing error message
          removeError();
          // Populate solution and tests into UI
          populateSolutions();
          populateTests();
        })
        .catch((err) => {
          showError(err);
        })
        .finally(() => {
          // TODO: set the button to not loading
        });
    }

    function showError(err) {
      
    }
  </script>

  <!-- TODO: TEST!! REMOVE BEFORE PUBLISHING -->
  <!-- <script src="./assets/patternpal-local-test.js"></script> -->
  <!-- <script src="./assets/patternpal-online-test.js"></script> -->

	<!-- Stats by Mint <haveamint.com> -->
	<script src="/mint/?js"></script>
</body>
</html>
